<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, shrink-to-fit=no"
    />
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <title>spatial-showcase</title>
    <script>
      // Immediate inline script to verify page loads and preserve hash
      console.log('[HTML] Page loaded, URL:', window.location.href);
      console.log('[HTML] Hash:', window.location.hash);
      console.log('[HTML] Query params:', window.location.search);
      
      // CRITICAL: Store hash IMMEDIATELY before any redirects can happen
      // This runs before any module scripts, ensuring we capture the hash
      if (window.location.hash) {
        const hash = window.location.hash;
        console.log('[HTML] ✅ Hash detected, storing in sessionStorage:', hash);
        try {
          sessionStorage.setItem('pendingShareToken', hash);
          sessionStorage.setItem('hashTimestamp', Date.now().toString());
          console.log('[HTML] ✅ Hash stored successfully');
        } catch (e) {
          console.error('[HTML] ❌ Failed to store hash:', e);
        }
      } else {
        // Check if we have a stored hash from a previous redirect
        const storedHash = sessionStorage.getItem('pendingShareToken');
        if (storedHash) {
          console.log('[HTML] ⚠️ Hash missing but found in sessionStorage:', storedHash);
          // Restore hash to URL if it was lost
          if (!window.location.hash && storedHash) {
            console.log('[HTML] Restoring hash to URL...');
            window.location.hash = storedHash;
          }
        }
      }
    </script>
  </head>
  <body style="margin: 0">
    <div id="scene-container"></div>
    <script type="module" src="/src/index.js"></script>
  </body>
</html>
